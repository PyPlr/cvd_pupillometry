{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Simple PLR\n",
    "==========\n",
    "\n",
    "This example demonstrates how to use the ``.light_stamper(...)`` and ``.pupil_grabber(...)`` methods to measure and plot a simple PLR relative to the onset of any light source given a suitable geometry, which in this case was a lightswitch in a dark room."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Waiting for a light to stamp...Grabbing 10 seconds of pupil.1.3d\n",
      "\n",
      "Waiting for futures...\n",
      "Waiting for futures...\n",
      "Waiting for futures...\n",
      "Light stamped on frame.world at 66498.433002\n",
      "Waiting for futures...\n",
      "Waiting for futures...\n",
      "Waiting for futures...\n",
      "Waiting for futures...\n",
      "Waiting for futures...\n",
      "PupilGrabber done grabbing 10 seconds of pupil.1.3d\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from time import sleep\n",
    "\n",
    "import numpy as np\n",
    "\n",
    "from pyplr.pupil import PupilCore\n",
    "from pyplr.utils import unpack_data_pandas\n",
    "from pyplr.preproc import butterworth_series\n",
    "\n",
    "# Some constants\n",
    "SAMPLE_RATE = 120\n",
    "BASELINE = 2\n",
    "DURATION = 6\n",
    "ONSET = BASELINE*SAMPLE_RATE\n",
    "\n",
    "# Set up pupil core\n",
    "p = PupilCore()\n",
    "\n",
    "# Annotation to be sent when the light comes on\n",
    "annotation = p.new_annotation('LIGHT_ON')\n",
    "    \n",
    "# Start LightStamper and PupilGrabber\n",
    "lst_future = p.light_stamper(\n",
    "    annotation, \n",
    "    threshold=15, \n",
    "    timeout=DURATION)\n",
    "pgr_future = p.pupil_grabber(\n",
    "    topic='pupil.1.3d', \n",
    "    seconds=BASELINE+DURATION+2)\n",
    "    \n",
    "# Wait a few seconds...\n",
    "sleep(BASELINE)\n",
    "\n",
    "# Shine the light! \n",
    "\n",
    "# Wait for the futures\n",
    "while lst_future.running() or pgr_future.running():\n",
    "    print('Waiting for futures...')\n",
    "    sleep(1)\n",
    "\n",
    "# Retrieve and process pupil data\n",
    "data = unpack_data_pandas(pgr_future.result(),\n",
    "                         cols=['timestamp', 'diameter_3d'])\n",
    "data = butterworth_series(\n",
    "    data, \n",
    "    filt_order=3, \n",
    "    cutoff_freq=4/(SAMPLE_RATE/2), \n",
    "    fields=['diameter_3d'])\n",
    "\n",
    "# Light_stamper timestamp\n",
    "ts = lst_future.result()[1]\n",
    "\n",
    "# Find the closest timestamp in the pupil data\n",
    "idx = (np.abs(ts - data.index)).argmin()\n",
    "\n",
    "# Trim and plot\n",
    "start = idx-BASELINE*SAMPLE_RATE\n",
    "end = idx+DURATION*SAMPLE_RATE\n",
    "data = data.iloc[start:end]\n",
    "data.reset_index(inplace=True)\n",
    "ax = data['diameter_3d'].plot()\n",
    "ax.axvline(x=ONSET, color='r')\n",
    "ax.set_xticks(range(0,len(data), SAMPLE_RATE+1))\n",
    "ax.set_xticklabels(range(-BASELINE,DURATION))\n",
    "ax.set_ylabel('Pupil size (mm)')\n",
    "ax.set_xlabel('Time relative to onset (s)')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
