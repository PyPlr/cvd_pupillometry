
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API documentation &#8212; PyPlr v1.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developers" href="08_developers.html" />
    <link rel="prev" title="Pupil Core device timing" href="pupil_core_timing_analysis.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-pyplr.pupil">
<span id="api-documentation"></span><h1>API documentation<a class="headerlink" href="#module-pyplr.pupil" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pyplr-pupil">
<h2>pyplr.pupil<a class="headerlink" href="#pyplr-pupil" title="Permalink to this headline">¶</a></h2>
<p>A module for interfacing with a Pupil Core eye tracker.</p>
<p>&#64;author: jtm</p>
<dl class="py class">
<dt id="pyplr.pupil.PupilCore">
<em class="property">class </em><code class="sig-prename descclassname">pyplr.pupil.</code><code class="sig-name descname">PupilCore</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">address</span><span class="o">=</span><span class="default_value">'127.0.0.1'</span></em>, <em class="sig-param"><span class="n">request_port</span><span class="o">=</span><span class="default_value">'50020'</span></em>, <em class="sig-param"><span class="n">pyplr_defaults</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to facilitate working with Pupil Core via the Network API.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">PupilCore</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;R my_recording&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyplr.pupil.PupilCore.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">address</span><span class="o">=</span><span class="default_value">'127.0.0.1'</span></em>, <em class="sig-param"><span class="n">request_port</span><span class="o">=</span><span class="default_value">'50020'</span></em>, <em class="sig-param"><span class="n">pyplr_defaults</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the connection with Pupil Core.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>address</strong> (<em>string</em><em>, </em><em>optional</em>) – The IP address of the device. The default is <cite>127.0.0.1</cite>.</p></li>
<li><p><strong>request_port</strong> (<em>string</em><em>, </em><em>optional</em>) – Pupil Remote accepts requests via a REP socket, by default on port
50020. Alternatively, you can set a custom port in Pupil Capture
or via the <cite>–port</cite> application argument. The default is <cite>50020</cite>.</p></li>
<li><p><strong>pyplr_defaults</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to configure Pupil Capture with the defaults used for the
<code class="docutils literal notranslate"><span class="pre">light_stamper(...)</span></code> method. This includes making sure the
Annotation Capture plugin is active, that frames are published in
BGR format, and that the world camera is using a frame rate of
(320,240) at 120 hz with exposure mode set to manual. Always
manually verify that the settings are appropriate for the
application you are running. The default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyplr.pupil.PupilCore.__weakref__">
<code class="sig-name descname">__weakref__</code><a class="headerlink" href="#pyplr.pupil.PupilCore.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.command">
<code class="sig-name descname">command</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cmd</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.command" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a command via <a class="reference external" href="https://docs.pupil-labs.com/developer/core/network-api/#pupil-remote">Pupil Remote</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cmd</strong> (<em>string</em>) – <p>Must be one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>’R’        - start recording with auto generated session name</p></li>
<li><p>’R my_rec’ - start recording named <cite>my_rec</cite></p></li>
<li><p>’r’        - stop recording</p></li>
<li><p>’C’        - start currently selected calibration</p></li>
<li><p>’c’        - stop currently selected calibration</p></li>
<li><p>’T 123.45’ - resets current Pupil time to given timestamp</p></li>
<li><p>’t’        - get current Pupil time; returns a float as string</p></li>
<li><p>’v’        - get the Pupil Core software version string</p></li>
<li><p>’PUB_PORT’ - return the current pub port of the IPC Backbone</p></li>
<li><p>’SUB_PORT’ - return the current sub port of the IPC Backbone</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the command. If the command was not acceptable, this
will be ‘Unknown command.’</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.detect_light_onset">
<code class="sig-name descname">detect_light_onset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotation</span></em>, <em class="sig-param"><span class="n">timeout</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">topic</span><span class="o">=</span><span class="default_value">'frame.world'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.detect_light_onset" title="Permalink to this definition">¶</a></dt>
<dd><p>Algorithm to detect onset of light stimulus with the World Camera.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annotation</strong> (<em>dict</em>) – <p>A dictionary with at least the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s1">&#39;topic&#39;</span><span class="p">:</span> <span class="s1">&#39;annotation&#39;</span><span class="p">,</span>
 <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;your label&gt;&#39;</span><span class="p">,</span>
 <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="kc">None</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>timestamp will be overwritten with the new pupil timestamp for the
detected light. See <code class="docutils literal notranslate"><span class="pre">.new_annotation(...)</span></code> for more info.</p>
</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – Time to wait in seconds before giving up. For <cite>STLAB</cite>, use 6 s,
because on rare occasions it can take about 5 seconds for the
<cite>LIGHT_HUB</cite> to process a request.</p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – Detection threshold for luminance increase. The right value depends
on the nature of the light stimulus and the ambient lighting
conditions. Requires some guesswork right now, but could easily
write a function that works it out for us.</p></li>
<li><p><strong>topic</strong> (<em>string</em>) – The camera frames to subscribe to. In most cases this will be
<cite>‘frame.world’</cite>, but the method will also work for <cite>‘frame.eye.0’</cite>
and <cite>‘frame.eye.1’</cite> if the light source contains enough near-
infrared. The default is <cite>‘frame.world’</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.fixation_trigger">
<code class="sig-name descname">fixation_trigger</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_dispersion</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">min_duration</span><span class="o">=</span><span class="default_value">300</span></em>, <em class="sig-param"><span class="n">trigger_region</span><span class="o">=</span><span class="default_value">[0.0, 0.0, 1.0, 1.0]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.fixation_trigger" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for a fixation that satisfies the given constraints.</p>
<p>Use to check for stable fixation before presenting a stimulus, for
example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses real-time data published by Pupil Capture’s <a class="reference external" href="https://docs.pupil-labs.com/developer/core/network-api/#fixation-messages">Online Fixation
Detector Plugin</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_dispersion</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum dispersion threshold in degrees of visual angle. In other
words, how much spatial movement is allowed within a fixation?
Pupil Capture allows manual selection of values from <cite>0.01</cite> to
<cite>4.91</cite>. The default is <cite>3.0</cite>.</p></li>
<li><p><strong>min_duration</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum duration threshold in milliseconds. In other words, what is
the minimum time required for gaze data to be within the dispersion
threshold? Pupil Capture allows manual selection of values from
<cite>10</cite> to <cite>4000</cite>. The default is <cite>300</cite>.</p></li>
<li><p><strong>trigger_region</strong> (<em>list</em><em>, </em><em>optional</em>) – World coordinates within which the fixation must fall to be valid.
The default is <code class="docutils literal notranslate"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0,</span> <span class="pre">1.0]</span></code>, which corresponds to the
whole camera scene in normalised coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fixation</strong> – The triggering fixation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.freeze_3d_model">
<code class="sig-name descname">freeze_3d_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eye_id</span></em>, <em class="sig-param"><span class="n">frozen</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.freeze_3d_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Freeze or unfreeze the 3D detector model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eye_id</strong> (<em>int</em>) – Whether to freeze the model for the left (1) or right (0) eye.</p></li>
<li><p><strong>frozen</strong> (<em>bool</em>) – Whether to freeze or unfreeze the model.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If eye_id is not specified correctly.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The notification response.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.get_corrected_pupil_time">
<code class="sig-name descname">get_corrected_pupil_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.get_corrected_pupil_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current Pupil Timestamp, corrected for transmission delay.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The current pupil time.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.get_next_camera_frame">
<code class="sig-name descname">get_next_camera_frame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subscriber</span></em>, <em class="sig-param"><span class="n">topic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.get_next_camera_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next camera frame.</p>
<p>Used by <code class="docutils literal notranslate"><span class="pre">.detect_light_onset(...)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subscriber</strong> (<em>zmq.sugar.socket.Socket</em>) – Subscriber to camera frames.</p></li>
<li><p><strong>topic</strong> (<em>string</em>) – Topic string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>recent_frame</strong> (<em>numpy.ndarray</em>) – The camera frame.</p></li>
<li><p><strong>recent_frame_ts</strong> (<em>float</em>) – Timestamp of the camera frame.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.get_pupil_detector_properties">
<code class="sig-name descname">get_pupil_detector_properties</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">detector_name</span></em>, <em class="sig-param"><span class="n">eye_id</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.get_pupil_detector_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the detector properties for a single pupil detector running in
a single eye process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detector_name</strong> (<em>string</em>) – <cite>‘Detector2DPlugin’</cite> or <cite>‘Pye3DPlugin’</cite>.</p></li>
<li><p><strong>eye_id</strong> (<em>int</em>) – For the left (0) or right(1) eye.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>payload</strong> – Dictionary of detector properties.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.grab_data">
<code class="sig-name descname">grab_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">topic</span></em>, <em class="sig-param"><span class="n">seconds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.grab_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Start grabbing data in real time from Pupil Core.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic</strong> (<em>string</em>) – <p>Subscription topic. Can be:</p>
<blockquote>
<div><ul>
<li><p>’pupil.0.2d’  - 2d pupil datum (left)</p></li>
<li><p>’pupil.1.2d’  - 2d pupil datum (right)</p></li>
<li><p>’pupil.0.3d’  - 3d pupil datum (left)</p></li>
<li><p>’pupil.1.3d’  - 3d pupil datum (right)</p></li>
<li><p>’gaze.3d.1.’  - monocular gaze datum</p></li>
<li><p>’gaze.3d.01.’ - binocular gaze datum</p></li>
<li><p>’logging’     - logging data</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>seconds</strong> (<em>float</em>) – Ammount of time to spend grabbing data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – A list of dictionaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.light_stamper">
<code class="sig-name descname">light_stamper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotation</span></em>, <em class="sig-param"><span class="n">timeout</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">topic</span><span class="o">=</span><span class="default_value">'frame.world'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.light_stamper" title="Permalink to this definition">¶</a></dt>
<dd><p>Concurrent timestamping of light stimuli with World Camera.</p>
<p>Executes the <code class="docutils literal notranslate"><span class="pre">.detect_light_onset(...)</span></code> method in a thread using
<code class="docutils literal notranslate"><span class="pre">concurrent.futures.ThreadPoolExecutor()</span></code>, returning a Future object
with access to the return value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annotation</strong> (<em>dict</em>) – </p></li>
<li><p><strong>timeout</strong> (<em>float</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – </p></li>
<li><p><strong>topic</strong> (<em>string</em>) – </p></li>
<li><p><strong>detect_light_onset</strong><strong>(</strong><strong>..</strong><strong>) </strong><strong>for more information on parameters.</strong> (<em>See</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">annotation</span> <span class="o">=</span> <span class="n">new_annotation</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;LIGHT_ON&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timeout</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">PupilCore</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst_future</span> <span class="o">=</span> <span class="n">pupil</span><span class="o">.</span><span class="n">lightstamper</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># light stimulus here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">lst_future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires a suitable geometry and for the World Camera to be pointed at
the light source. Also requires the following settings in Pupil Capture:</p>
<ul class="simple">
<li><p>Auto Exposure mode - Manual Exposure (eye and world)</p></li>
<li><p>Frame publisher format - BGR</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An object giving access to the data from the thread.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>concurrent.futures._base_Future</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.new_annotation">
<code class="sig-name descname">new_annotation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">custom_fields</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.new_annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new <a class="reference external" href="https://docs.pupil-labs.com/core/software/pupil-capture/#annotations">annotation</a>
(a.k.a. message / event marker / whatever you want to call it). Send it
to Pupil Capture with the <code class="docutils literal notranslate"><span class="pre">.send_annotation(...)</span></code> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default timestamp for an annotation is the current Pupil time
(corrected for transmission delay) at the time of creation, but this
can be overridden at a later point if desired.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>string</em>) – A label for the event.</p></li>
<li><p><strong>custom_fields</strong> (<em>dict</em><em>, </em><em>optional</em>) – Any additional information to add (e.g., <code class="docutils literal notranslate"><span class="pre">{'duration':</span> <span class="pre">2,</span>
<span class="pre">'color':</span> <span class="pre">'blue'}</span></code>).
The default is <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>annotation</strong> – The annotation dictionary, ready to be sent.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.notify">
<code class="sig-name descname">notify</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">notification</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a <a class="reference external" href="https://docs.pupil-labs.com/developer/core/network-api/#notification-message">notification</a>
to Pupil Remote.</p>
<p>Every notification has a topic and can contain potential payload data.
The payload data has to be serializable, so not every Python object
will work. To find out which plugins send and receive notifications,
open the codebase and search for <code class="docutils literal notranslate"><span class="pre">.notify_all(</span></code> and <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">on_notify(</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>notification</strong> (<em>dict</em>) – <p>The notification dict. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="s1">&#39;start_plugin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Annotation_Capture&#39;</span><span class="p">,</span>
 <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">{}})</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The response.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.pupil_grabber">
<code class="sig-name descname">pupil_grabber</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">topic</span></em>, <em class="sig-param"><span class="n">seconds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.pupil_grabber" title="Permalink to this definition">¶</a></dt>
<dd><p>Concurrent access to data from Pupil Core.</p>
<p>Executes the <code class="docutils literal notranslate"><span class="pre">.grab_data(...)</span></code> method in a thread using
<code class="docutils literal notranslate"><span class="pre">concurrent.futures.ThreadPoolExecutor()</span></code>, returning a Future object
with access to the return value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic</strong> (<em>string</em>) – See <code class="docutils literal notranslate"><span class="pre">.grab_data(...)</span></code> for more info.</p></li>
<li><p><strong>seconds</strong> (<em>float</em>) – Ammount of time to spend grabbing data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">PupilCore</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seconds</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgr_future</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">pupil_grabber</span><span class="p">(</span><span class="n">topic</span><span class="o">=</span><span class="s1">&#39;pupil.0.3d&#39;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="n">seconds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pgr_future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An object giving access to the data from the thread.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>concurrent.futures._base_Future</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.recv_from_subscriber">
<code class="sig-name descname">recv_from_subscriber</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subscriber</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.recv_from_subscriber" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a message with topic and payload.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subscriber</strong> (<em>zmq.sugar.socket.Socket</em>) – A subscriber to any valid topic.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>topic</strong> (<em>str</em>) – A utf-8 encoded string, returned as a unicode object.</p></li>
<li><p><strong>payload</strong> (<em>dict</em>) – A msgpack serialized dictionary, returned as a python dictionary.
Any addional message frames will be added as a list in the payload
dictionary with key: <code class="docutils literal notranslate"><span class="pre">'__raw_data__'</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.send_annotation">
<code class="sig-name descname">send_annotation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotation</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.send_annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Send an annotation to Pupil Capture.</p>
<p>Use to mark the timing of events.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>annotation</strong> (<em>dict</em>) – Customiseable - see the <code class="docutils literal notranslate"><span class="pre">.new_annotation(...)</span></code> method.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.pupil.PupilCore.subscribe_to_topic">
<code class="sig-name descname">subscribe_to_topic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">topic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.pupil.PupilCore.subscribe_to_topic" title="Permalink to this definition">¶</a></dt>
<dd><p>Subscribe to a topic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topic</strong> (<em>string</em>) – The topic to which you want to subscribe, e.g., <cite>‘pupil.1.3d’</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subscriber</strong> – Subscriber socket.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>zmq.sugar.socket.Socket</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-pyplr.stlab"></span><div class="section" id="pyplr-stlab">
<h2>pyplr.stlab<a class="headerlink" href="#pyplr-stlab" title="Permalink to this headline">¶</a></h2>
<p>A python wrapper for Ledmotive’s Spectra Tune Lab light engine and RESTful API.
Also contains other useful functions for working with STLAB. See the “LIGHT HUB
RESTful API” manual for further functions and more info. Note that a license is
required to develop against the RESTful API.</p>
<dl class="py class">
<dt id="pyplr.stlab.SpectraTuneLab">
<em class="property">class </em><code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">SpectraTuneLab</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">password</span></em>, <em class="sig-param"><span class="n">username</span><span class="o">=</span><span class="default_value">'admin'</span></em>, <em class="sig-param"><span class="n">identity</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">lighthub_ip</span><span class="o">=</span><span class="default_value">'192.168.7.2'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for LEDMOTIVE Spectra Tune Lab RESTFUL_API.</p>
<dl class="py attribute">
<dt id="pyplr.stlab.SpectraTuneLab.colors">
<code class="sig-name descname">colors</code><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Matplotlib colornames for the 10 channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyplr.stlab.SpectraTuneLab.rgb_colors">
<code class="sig-name descname">rgb_colors</code><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.rgb_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>RGB colors of the 10 channels taken from photographs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyplr.stlab.SpectraTuneLab.wlbins">
<code class="sig-name descname">wlbins</code><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.wlbins" title="Permalink to this definition">¶</a></dt>
<dd><p>The wavelength bins for the on-board spectrometer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyplr.stlab.SpectraTuneLab.min_intensity">
<code class="sig-name descname">min_intensity</code><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.min_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum intensity setting for LEDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyplr.stlab.SpectraTuneLab.max_intensity">
<code class="sig-name descname">max_intensity</code><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.max_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum intensity setting for the LEDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Synchronous mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set each LED to maximum for a few seconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">SpectraTuneLab</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="n">identitiy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">led</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">spectrum</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>
<span class="gp">... </span>    <span class="n">spectrum</span><span class="p">[</span><span class="n">led</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4095</span>
<span class="gp">... </span>    <span class="n">d</span><span class="o">.</span><span class="n">set_spectrum_a</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">sleep</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Asynchronous mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create and play a video file setting all LEDs to maximum for 1 second</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulse_protocol</span><span class="p">(</span><span class="n">pulse_spec</span><span class="o">=</span><span class="p">[</span><span class="mi">4095</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">pulse_duration</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">video_name</span><span class="o">=</span><span class="s1">&#39;my_video_file&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">SpectraTuneLab</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="n">identitiy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">load_video_file</span><span class="p">(</span><span class="s1">&#39;my_video_file&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">play_video_file</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">password</span></em>, <em class="sig-param"><span class="n">username</span><span class="o">=</span><span class="default_value">'admin'</span></em>, <em class="sig-param"><span class="n">identity</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">lighthub_ip</span><span class="o">=</span><span class="default_value">'192.168.7.2'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize connection with LightHub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>string</em>) – The username for logging in.</p></li>
<li><p><strong>identity</strong> (<em>int</em>) – A unique numerical identifier for the device.</p></li>
<li><p><strong>password</strong> (<em>string</em>) – The password specific to the LightHub.</p></li>
<li><p><strong>lightub_ip</strong> (<em>string</em><em>, </em><em>optional</em>) – The IP address of the LightHub device. The default is
<cite>‘192.168.7.2’</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Mac connection driver usually creates the network in a way that
places the LightHub device at IP 192.168.6.2 instead of IP 192.168.7.2,
so this may need to be changed depending on the platform. If that is
not enough, you might need to also install the two (
<a class="reference external" href="https://beagleboard.org/static/Drivers/MacOSX/RNDIS/HoRNDIS.pkg">Network</a>
and
<a class="reference external" href="https://beagleboard.org/static/Drivers/MacOSX/FTDI/EnergiaFTDIDrivers2.2.18.pkg">Serial</a>
) Mac OX drivers required by the BeagleBone (the LightHub motherboard).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyplr.stlab.SpectraTuneLab.__weakref__">
<code class="sig-name descname">__weakref__</code><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.color_xy">
<code class="sig-name descname">color_xy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">intensity_values</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.color_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to the <cite>spectruma</cite> command, but allows setting a target
<cite>x, y</cite> coordinates in the CIE1931 color space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensity_values</strong> (<em>list</em>) – The desired spectrum as a list of integers.</p></li>
<li><p><strong>x</strong> (<em>float</em>) – Desired target CIE1931 <cite>x</cite> coordinate as a decimal number.</p></li>
<li><p><strong>y</strong> (<em>float</em>) – Desired target CIE1931 <cite>y</cite> coordinate as a decimal number.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_colour_priority">
<code class="sig-name descname">get_colour_priority</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_colour_priority" title="Permalink to this definition">¶</a></dt>
<dd><p>Get current color priority configuration for this luminaire.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>colour_priority</strong> – Whether colour priority is enabled.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_device_info">
<code class="sig-name descname">get_device_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_device_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the device characteristics and basic configuration. These
are the serial code, the model code, the number of channels for this
luminaire and the device feedback type (whether it is colorimeter or
spectrometer). How are the serial and model codes is yet to be defined,
but expect a maximum 50 character length code for serial and 30 for
model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The device info.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_dimming_level">
<code class="sig-name descname">get_dimming_level</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_dimming_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the user intensity dimmer. See <cite>set_dimming_level(…)</cite> for
more info.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_input_power">
<code class="sig-name descname">get_input_power</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_input_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current consumed electrical power of the luminaire in
mW.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>input_power</strong> – The electrical power at the luminaire in mW.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_led_calibration">
<code class="sig-name descname">get_led_calibration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_led_calibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current LED calibration matrix containing 10 rows
(for each channel) and 81 columns (intensity value from 380 to 780 nm
in steps of 5 nm).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>matrix</strong> – 10 x 81 calibration matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_multicast_address">
<code class="sig-name descname">get_multicast_address</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_multicast_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the array of multicast addresses set in the luminaire. See
<cite>.set_multicast_address(…)</cite> for more info.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_pcb_temperature">
<code class="sig-name descname">get_pcb_temperature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_pcb_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the PCB temperature in Celsius degrees (ºC). Returns a list
of 4 elements in this order: LEDs, Drivers, Spectrometer and
Microcontroller temperature sensors close to these elements. If one
sensor or its readout is not available a null value is returned for
that element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None.</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>temperatures</strong> – [Number, Number, Number, Number].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_spectrometer_integration_time">
<code class="sig-name descname">get_spectrometer_integration_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_spectrometer_integration_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current integration time used by the spectrometer for
gathering data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>integration_time</strong> – A positive integer ranging from 50 to 140000 in tenths of
millisecond.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_spectrometer_spectrum">
<code class="sig-name descname">get_spectrometer_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_spectrometer_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spectrum readout from the internal spectrometer. If the
luminaire does only contain a colorimeter sensor, a theoretical
spectrum based on the current channel’s power is obtained instead. The
data is returned in 81 elements that represents a 5 nm wavelength bins
from 380 nm to 780 nm. Each element is a value ranging from 0 to 65535
abstracting the light intensity at each point and allowing the
reconstruction of the spectral shape. An additional element represents
the radiometric value in milliWatts (mW) at the peak of a max value of
a spectrum at which the abstracted values are normalized, i.e. the
flux corresponding to a 65535 value in the array. This flux depends on
multiple factors, as current channels power, dimming level, power
protection and maximum power of the lighted LEDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>norm</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to normalize the spectrum to its peak radiometric value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spectrum</strong> – [Number, Number, …, Number, Number] with 81 elements.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.get_spectrum_a">
<code class="sig-name descname">get_spectrum_a</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.get_spectrum_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current amplitude for each of the luminaire channels.
The array returned has a length equal to the channel count of the
luminaire. Each value in the array is a representation of electrical
counts, ranging from 0 to 4095 counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.load_video_file">
<code class="sig-name descname">load_video_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">return_vf_dict</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.load_video_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Uploads a video light sequence file to the LIGHT HUB. The video
file must follow the LEDMOTIVE Dynamic Sequence File (.dsf) format.
The uploaded file must be a json file (.dsf files are json files),
with weight less than 2 MB. The file must be uploaded using the
multipart / form-data standard convention. See <code class="docutils literal notranslate"><span class="pre">play_video_file(...)</span></code>
for how to play the uploaded file in a luminaire.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>video</strong> (<em>string</em>) – Name of the video file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Video file dictionary if <cite>return_vf_dict</cite> is True else None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.play_video_file">
<code class="sig-name descname">play_video_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">broadcast</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.play_video_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the execution of a light video sequence in the specified
luminaire or multicast address. If no video is in the LIGHT HUB, an
error response is raised, and the command ignored. If the video is
already playing, the play is interrupted, and the video is reproduced
back from the beginning. To stop the video, use <cite>stop=True</cite>. See
<cite>load_video_file(…)</cite> for how to load a video file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broadcast</strong> (<em>bool</em>) – Whether to issue the commmand via the broadcast address 1023. This
avoids a bug at startup. The default is True.</p></li>
<li><p><strong>stop</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the command should stop the video. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_blink">
<code class="sig-name descname">set_blink</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blink</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_blink" title="Permalink to this definition">¶</a></dt>
<dd><p>Commands the luminaire to blink. The value provided as an argument
is the number of times the light blinks in one second.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>blink</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times the light should blink in one second. The default
is 1.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_color">
<code class="sig-name descname">set_color</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">flux</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a light color represented in the CIE1931 color space. The
<cite>x</cite> and <cite>y</cite> coordinates are the mathematical index that represents the
target color to be achieved. If the <cite>x,y</cite> provided values are not
available by the system, it will find its nearest available x,y
coordinates. If flux is provided as an argument, it will be adjusted
automatically, otherwise the current flux will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Desired target CIE1931 <cite>x</cite> coordinate as a decimal number.</p></li>
<li><p><strong>y</strong> (<em>float</em>) – Desired target CIE1931 <cite>y</cite> coordinate as a decimal number.</p></li>
<li><p><strong>flux</strong> (<em>int</em><em>, </em><em>optional</em>) – Value between 0 and 4095. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_colour_priority">
<code class="sig-name descname">set_colour_priority</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">colour_priority</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_colour_priority" title="Permalink to this definition">¶</a></dt>
<dd><p>Command the luminaire to always first approximate to the desired
color of the spectrum to set before setting the spectrum channel
values. This function is set to true or false (enabled or disabled).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>colour_priority</strong> (<em>bool</em>) – Whether to enable or disable colour priority.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_dimming_level">
<code class="sig-name descname">set_dimming_level</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dimming_level</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_dimming_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets an intensity dimmer. This percentage modulates the current
intensity by multiplying the power count of each luminaire channel,
i.e. if you send a spectrum where each channel count is at half level
and the dimming is set at 50%, the final light intensity will be one
quarter of the luminaire full capacity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dimming_level</strong> (<em>int</em>) – Percentage dimming level.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_multicast_address">
<code class="sig-name descname">set_multicast_address</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">address</span><span class="o">=</span><span class="default_value">[1001, None, None, None]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_multicast_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets an array of multicast addresses accepted by the luminaire. A
multicast address can be shared by different luminaires. Thus, when
using a multicast address as the luminaire id of one request, the
appropriate command is issued to all the luminaires sharing the same
multicast address. Currently only the response of the first luminaire
to answer is returned to the caller client. Currently 4 multicast
addresses can be set in a single luminaire (which effectively limits
the number of groups a luminaire can be part of to 4, without counting
the broadcast group). Each address should be in the range 1 - 1022 and
should not be already in use by any luminaire id. The multicast address
1023 is shared by all luminaires without the need to include it in this
list, and can be used as a broadcast address to request commands in all
the installation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>address</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is [15,None,None,None].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_spectrometer_integration_time">
<code class="sig-name descname">set_spectrometer_integration_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">integration_time</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_spectrometer_integration_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the integration time of the spectrometer to gather data. Longer
times will result in more light reaching the sensor (like exposure
time in photography). Special attention should be taken to avoid
signal saturation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>integration_time</strong> (<em>int</em>) – A positive integer ranging from 50 to 140000 in tenths of
millisecond.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_spectrum_a">
<code class="sig-name descname">set_spectrum_a</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">intensity_values</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_spectrum_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a spectrum based on the intensity values provided for each
of the channels. Each channel can be set between 0 and 4095 (only integer
values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>intensity_values</strong> (<em>list</em>) – List of 10 integer values between 0 and 4095.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.set_spectrum_s">
<code class="sig-name descname">set_spectrum_s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spectrum</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.set_spectrum_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the given spectrum. The spectrum is defined by an array of
81 elements that represents 5 nm wavelength bins from 380 nm to 780 nm.
The values are an abstraction of the light intensity at each point
that allows the reconstruction of the spectrum shape. Each value ranges
between 0 and 65535, 0 being no intensity and 65535 being full intensity
at the corresponding wavelength bin (prior application of dimming and
power protection caps).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spectrum</strong> (<em>list</em>) – List of 81 (the 380 nm to 780 nm bins) integer values between
0 and 65535.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.spectruma">
<code class="sig-name descname">spectruma</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">intensity_values</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.spectruma" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a spectrum based on the intensity values provided for each
of the channels. Each channel can be set between 0 and 4095. This is an
alternative way to the command <cite>set_spectrum_a</cite> that allows setting a
spectrum issuing a <cite>GET</cite> command (which allows access to the luminaire
by typing a url in any browser).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>intensity_values</strong> (<em>list</em>) – List of 10 integer values between 0 and 4095.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.stlab.SpectraTuneLab.turn_off">
<code class="sig-name descname">turn_off</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.SpectraTuneLab.turn_off" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops light emission by setting the power at all channels to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None.</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.background_pulse_protocol">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">background_pulse_protocol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">background_spec</span></em>, <em class="sig-param"><span class="n">pre_pulse_duration</span></em>, <em class="sig-param"><span class="n">pulse_spec</span></em>, <em class="sig-param"><span class="n">pulse_duration</span></em>, <em class="sig-param"><span class="n">post_pulse_duration</span></em>, <em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'our_video_file'</span></em>, <em class="sig-param"><span class="n">return_df</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.background_pulse_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a video file to deliver a pulse of light (or dark) against a
background of light (or dark). Clunky but works well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>background_spec</strong> (<em>list</em>) – The background spectrum.</p></li>
<li><p><strong>pre_pulse_duration</strong> (<em>int</em>) – Duration of the background prior to pulse.</p></li>
<li><p><strong>pulse_spec</strong> (<em>list</em>) – The pulse spectrum..</p></li>
<li><p><strong>pulse_duration</strong> (<em>int</em>) – Duration of the pulse in ms.</p></li>
<li><p><strong>post_pulse_duration</strong> (<em>int</em>) – Duration of the background after the pulse..</p></li>
<li><p><strong>fname</strong> (<em>str</em><em>, </em><em>optional</em>) – Name for the video file. The default is ‘our_video_file’.</p></li>
<li><p><strong>return_df</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the DataFrame. The default is False.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – Additional info to include in the metadata field of the video file
(e.g. {‘color’ : ‘blue’}). This info can be extracted when loading the
file during an experiment and included in triggers sent to Pupil
Capture. The default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>df</strong> – The DataFrame passed to make_video_file (if requested).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.explore_spectra">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">explore_spectra</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spectra</span></em>, <em class="sig-param"><span class="n">binwidth</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.explore_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes a DataFrame of spectra and plots them, along with other
useful info.</p>
</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.make_video_file">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">make_video_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'our_video_file'</span></em>, <em class="sig-param"><span class="n">repeats</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">metadata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.make_video_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a DataFrame with columns ‘time’, ‘LED-1’…’LED-10’
and save it as a .dsf (‘dynamic sequence file’) in the current
working directory. The .dsf file can be loaded and played as a video stream
with the STLAB.</p>
</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.pulse_protocol">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">pulse_protocol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pulse_spec</span></em>, <em class="sig-param"><span class="n">pulse_duration</span></em>, <em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'our_video_file'</span></em>, <em class="sig-param"><span class="n">return_df</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.pulse_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a video file to deliver a pulse of light.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> (<em>list</em>) – Sprectrum to use for the pulse of light.</p></li>
<li><p><strong>duration</strong> (<em>int</em>) – Duration of the pulse in ms.</p></li>
<li><p><strong>video_name</strong> (<em>str</em>) – Name for the video file.</p></li>
<li><p><strong>return_df</strong> (<em>bool</em>) – Whether to return the DataFrame used to create the video file.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – Additional info to include in the metadata of the video file (e.g.
‘color’ : ‘blue’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>df</strong> – The DataFrame passed to make_video_file (if requested).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.spec_to_xyz">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">spec_to_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span></em>, <em class="sig-param"><span class="n">cmf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.spec_to_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a spectrum to an xyz point.</p>
<p>The spectrum must be on the same grid of points as the colour-matching
function, cmf: 380-780 nm in 5 nm steps.</p>
</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.spectra_to_peak_wavelengths">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">spectra_to_peak_wavelengths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spectra</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.spectra_to_peak_wavelengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the peak wavelengths for a given set of spectra.</p>
</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.spectra_to_xyz">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">spectra_to_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spectra</span></em>, <em class="sig-param"><span class="n">binwidth</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.spectra_to_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the CIE 1931 xy chromaticity coordinates for a collection of
spectra. The DataFrame must have columns (or multi index) with names</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spectra</strong> (<em>DataFrame</em>) – As output by stlab.sample</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xyz</strong> – The xyz values for each spectrum.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.stlab.video_file_to_dict">
<code class="sig-prename descclassname">pyplr.stlab.</code><code class="sig-name descname">video_file_to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">video_file</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.stlab.video_file_to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack a video file into a dictionary with keys [‘header’, ‘metadata’,
‘spectra’, ‘transitions’]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>video_file</strong> (<em>str</em>) – The video file to unpack.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – the video file as a dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pyplr.oceanops"></span><div class="section" id="pyplr-oceanops">
<h2>pyplr.oceanops<a class="headerlink" href="#pyplr-oceanops" title="Permalink to this headline">¶</a></h2>
<p>A module to help with measurents for Ocean Optics spectrometers.</p>
<dl class="py class">
<dt id="pyplr.oceanops.OceanOptics">
<em class="property">class </em><code class="sig-prename descclassname">pyplr.oceanops.</code><code class="sig-name descname">OceanOptics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.oceanops.OceanOptics" title="Permalink to this definition">¶</a></dt>
<dd><p>Device class for Ocean Optics spectrometer with user-defined methods.</p>
<dl class="py method">
<dt id="pyplr.oceanops.OceanOptics.dark_measurement">
<code class="sig-name descname">dark_measurement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">integration_times</span><span class="o">=</span><span class="default_value">[1000]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.oceanops.OceanOptics.dark_measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample the dark spectrum with a range of integration times.</p>
<p>Do this for a range of temperatures to map the relationship between
temperature and integration time.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.oceanops.OceanOptics.measurement">
<code class="sig-name descname">measurement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">integration_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">setting</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.oceanops.OceanOptics.measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a measurement with an Ocean Optics spectrometer.</p>
<p>If <cite>integration_time</cite> is not specified, will use an adaptive procedure
that avoids saturation by aiming for a maximum reported value of
80-90% of the maximum intensity value for the device. Can take up to a
maximum of ~3.5 mins for lower light levels, though this could be
reduced somewhat by optimising the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integration_time</strong> (<em>int</em>) – The integration time to use for the measurement. Leave as None to
adaptively set the integration time based on spectral measurements.</p></li>
<li><p><strong>setting</strong> (<em>dict</em><em>, </em><em>optional</em>) – Current setting of the light source (if known), to be included in
the <cite>info</cite>. For example <code class="docutils literal notranslate"><span class="pre">{'led'</span> <span class="pre">:</span> <span class="pre">5,</span> <span class="pre">'intensity'</span> <span class="pre">:</span> <span class="pre">3000}</span></code>, or
<code class="docutils literal notranslate"><span class="pre">{'intensities'</span> <span class="pre">:</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">300,</span> <span class="pre">4000,</span> <span class="pre">200,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]}</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>counts</strong> (<em>np.array</em>) – Raw intensity counts from the Ocean Optics spectrometer.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Companion info for measurement.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyplr.oceanops.predict_dark_counts">
<code class="sig-prename descclassname">pyplr.oceanops.</code><code class="sig-name descname">predict_dark_counts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spectra_info</span></em>, <em class="sig-param"><span class="n">darkcal</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.oceanops.predict_dark_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict dark counts from temperature and integration times.</p>
<p>These must be subtracted from measured pixel counts during the
unit-calibration process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectra_info</strong> (<em>pd.DataFrame</em>) – The info dataframe containing the ‘board_temp’ and ‘integration_time’
variables.</p></li>
<li><p><strong>calfile</strong> (<em>string</em>) – Path to the calibration file. This is currenly generated in MATLAB.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The predicted dark spectra.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pyplr.calibrate"></span><div class="section" id="pyplr-calibrate">
<h2>pyplr.calibrate<a class="headerlink" href="#pyplr-calibrate" title="Permalink to this headline">¶</a></h2>
<p>Module to assist with calibrating the sphere.</p>
<p>&#64;author: jtm</p>
<dl class="py class">
<dt id="pyplr.calibrate.CalibrationContext">
<em class="property">class </em><code class="sig-prename descclassname">pyplr.calibrate.</code><code class="sig-name descname">CalibrationContext</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">binwidth</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a calibration context based on spectrometer measurements.</p>
<p>Automatically creates a forward model of the device with linear
interpolation. Currently this requires the measurements to be for each LED
in steps of 65.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cc</span> <span class="o">=</span> <span class="n">CalibrationContext</span><span class="p">(</span><span class="s1">&#39;spectrometer_data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">plot_calibrated_spectra</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyplr.calibrate.CalibrationContext.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">binwidth</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>str</em>) – Path to a csv file of calibrated spectrometer data. Must contain
columns ‘led’ and ‘intensity’.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em>) – Binwidth of spectrometer data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyplr.calibrate.CalibrationContext.__weakref__">
<code class="sig-name descname">__weakref__</code><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.CalibrationContext.create_alphaopic_irradiances_table">
<code class="sig-name descname">create_alphaopic_irradiances_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.create_alphaopic_irradiances_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the CIE026 spectral sensetivities, calculate alphaopic
irradiances (S, M, L, Rhod and Melanopic) for every spectrum in
<cite>self.lkp</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Alphaopic irradiances.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.CalibrationContext.create_lookup_table">
<code class="sig-name descname">create_lookup_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.create_lookup_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Using <cite>self.data</cite>, create a lookup table for all settings with
linear interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>lkp_tbl</strong> – Interpolated data.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.CalibrationContext.create_lux_table">
<code class="sig-name descname">create_lux_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.create_lux_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the CIE1924 photopic luminosity function, calculate lux for
every spectrum in <cite>self.lkp</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Lux values.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.CalibrationContext.match">
<code class="sig-name descname">match</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">match_led</span></em>, <em class="sig-param"><span class="n">match_led_intensity</span></em>, <em class="sig-param"><span class="n">target_led</span></em>, <em class="sig-param"><span class="n">match_type</span><span class="o">=</span><span class="default_value">'irrad'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.match" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the appropriate intensity setting for <cite>target_led</cite> so that
its output will match <cite>match_led</cite> at <cite>match_led_intensity</cite> with respect
to <cite>match_type</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>match_led</strong> (<em>int</em>) – The led to be matched.</p></li>
<li><p><strong>match_led_intensity</strong> (<em>int</em>) – The intensity of the led to be matched.</p></li>
<li><p><strong>target_led</strong> (<em>int</em>) – The led whose intensity is to be determined.</p></li>
<li><p><strong>match_type</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>The type of match to be performed. One of:</p>
<blockquote>
<div><ul>
<li><p>’irrad’ - overall (unweighted) irradiance</p></li>
<li><p>’lux’   - lux</p></li>
<li><p>’mel’   - melanopic irradiance</p></li>
<li><p>’rhod’  - rhodopic irradiance</p></li>
<li><p>’s’     - s-cone-opic irradiance</p></li>
<li><p>’m’     - m-cone-opic irradiance</p></li>
<li><p>’l’     - l-cone-opic irradiance</p></li>
</ul>
</div></blockquote>
<p>The default is ‘irrad’.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>error</strong> (<em>float</em>) – The absolute matching error.</p></li>
<li><p><strong>match_intensity</strong> (<em>int</em>) – The required intensity for <cite>match_led</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.CalibrationContext.plot_calibrated_spectra">
<code class="sig-name descname">plot_calibrated_spectra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.plot_calibrated_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the calibrated spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>fig</strong> – The plot.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Matplotlib.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.CalibrationContext.predict_spd">
<code class="sig-name descname">predict_spd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">intensities</span><span class="o">=</span><span class="default_value">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></em>, <em class="sig-param"><span class="n">asdf</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.CalibrationContext.predict_spd" title="Permalink to this definition">¶</a></dt>
<dd><p>Using <cite>self.lkp</cite>, predict the spectral power distribution for a
given list of led intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>intensities</strong> (<em>list</em>) – List of intensity values for each led. The default is
<code class="docutils literal notranslate"><span class="pre">[0,0,0,0,0,0,0,0,0,0]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spectrum</strong> – Predicted spectrum for given intensities.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyplr.calibrate.SpectraTuneLabSampler">
<em class="property">class </em><code class="sig-prename descclassname">pyplr.calibrate.</code><code class="sig-name descname">SpectraTuneLabSampler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">username</span></em>, <em class="sig-param"><span class="n">identity</span></em>, <em class="sig-param"><span class="n">password</span></em>, <em class="sig-param"><span class="n">lighthub_ip</span><span class="o">=</span><span class="default_value">'192.168.7.2'</span></em>, <em class="sig-param"><span class="n">external</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.SpectraTuneLabSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass of <cite>stlab.SpectraTuneLab</cite> with added sampling methods.</p>
<p>Optional support for concurrent measurements with external spectrometer.</p>
<dl class="py method">
<dt id="pyplr.calibrate.SpectraTuneLabSampler.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">username</span></em>, <em class="sig-param"><span class="n">identity</span></em>, <em class="sig-param"><span class="n">password</span></em>, <em class="sig-param"><span class="n">lighthub_ip</span><span class="o">=</span><span class="default_value">'192.168.7.2'</span></em>, <em class="sig-param"><span class="n">external</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.SpectraTuneLabSampler.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize class and subclass. See <cite>pyplr.stlab.SpectraTuneLab</cite> for
more info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>external</strong> (<em>Class</em><em>, </em><em>optional</em>) – Acquire concurrent measurements with an external spectrometer.
Must be a device class with <code class="docutils literal notranslate"><span class="pre">.measurement(...)</span></code> and
<code class="docutils literal notranslate"><span class="pre">.wavelengths(...)</span></code> methods. See <cite>pyplr.oceanops.OceanOptics</cite>
for an example.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.SpectraTuneLabSampler.full_readout">
<code class="sig-name descname">full_readout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">setting</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.SpectraTuneLabSampler.full_readout" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a full readout from STLAB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm</strong> (<em>bool</em>) – Whether to normalise the spectrum to the peak radiometric value.</p></li>
<li><p><strong>setting</strong> (<em>dict</em><em>, </em><em>optional</em>) – The current setting of the luminaire (if known), to be included in
the <cite>info_dict</cite>. For example <code class="docutils literal notranslate"><span class="pre">{'led'</span> <span class="pre">:</span> <span class="pre">5,</span> <span class="pre">'intensity'</span> <span class="pre">:</span> <span class="pre">3000}</span></code>,
or <code class="docutils literal notranslate"><span class="pre">{'intensities'</span> <span class="pre">:</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">300,</span> <span class="pre">4000,</span> <span class="pre">200,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]}</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>spec</strong> (<em>np.array</em>) – The spectrum.</p></li>
<li><p><strong>info_dict</strong> (<em>dict</em>) – Dictionary of information for spectrometer reading.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.SpectraTuneLabSampler.make_dfs">
<code class="sig-name descname">make_dfs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_csv</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.SpectraTuneLabSampler.make_dfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn cached data and info into pandas DataFrames and optionally
save to csv format.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.calibrate.SpectraTuneLabSampler.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">leds</span><span class="o">=</span><span class="default_value">[0]</span></em>, <em class="sig-param"><span class="n">intensities</span><span class="o">=</span><span class="default_value">[500]</span></em>, <em class="sig-param"><span class="n">spectra</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wait_before_sample</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">ocean_optics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">randomise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.calibrate.SpectraTuneLabSampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a set of LEDs individually at a range of specified
intensities using STLABs on-board spectrometer. Alternatively, sample
a set of pre-defined spectra. Option to also obtain concurrent
measurements with an external Ocean Optics spectrometer. Data are
stored in class lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leds</strong> (<em>list</em><em>, </em><em>optional</em>) – List of unique integers from 0-9 representing the LEDs to sample.
The default is [0].</p></li>
<li><p><strong>intensities</strong> (<em>list</em><em>, </em><em>optional</em>) – List of integer values between 0-4095 representing the intensity
values at which to sample the LEDs. The default is [500].</p></li>
<li><p><strong>spectra</strong> (<em>list</em><em>, </em><em>optinal</em>) – List of predfined spectra to sample. Must be None if specifying
leds or intensities. The default is None.</p></li>
<li><p><strong>wait_before_sample</strong> (<em>float</em><em>, </em><em>optional</em>) – Time in seconds to wait after setting a spectrum before acquiring
a measurement from the spectrometer(s). The default is .2.</p></li>
<li><p><strong>randomise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to randomise the order in which the LED-intensity settings
or spectra are sampled. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-pyplr.CIE"></span><div class="section" id="pyplr-cie">
<h2>pyplr.CIE<a class="headerlink" href="#pyplr-cie" title="Permalink to this headline">¶</a></h2>
<p>Convenience functions for accessing CIE standards.</p>
<p>&#64;author: jtm</p>
<dl class="py function">
<dt id="pyplr.CIE.get_CIES026">
<code class="sig-prename descclassname">pyplr.CIE.</code><code class="sig-name descname">get_CIES026</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">asdf</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">binwidth</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.CIE.get_CIES026" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the CIE026 spectral sensitivities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asdf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the results as a pandas DataFrame. The default is
False.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the wavelength bins in nanometers (must be <cite>1</cite> or <cite>5</cite>). The
default is <cite>1</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sss</strong> – CIES026 spectral sensitivities for s, m, l, rods, and melanopsin.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray or pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.CIE.get_CIE_1924_photopic_vl">
<code class="sig-prename descclassname">pyplr.CIE.</code><code class="sig-name descname">get_CIE_1924_photopic_vl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">asdf</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">binwidth</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.CIE.get_CIE_1924_photopic_vl" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the CIE1924 photopic luminosity function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asdf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the results as a pandas DataFrame. The default is
False.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the wavelength bins in nanometers (must be <cite>1</cite> or <cite>5</cite>). The
default is <cite>1</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vl</strong> – The CIE1924 photopic luminosity function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray or pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.CIE.get_CIE_CMF">
<code class="sig-prename descclassname">pyplr.CIE.</code><code class="sig-name descname">get_CIE_CMF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">asdf</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">binwidth</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.CIE.get_CIE_CMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the CIE 1931 XYZ 2-deg color matching functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asdf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the results as a pandas DataFrame. The default is
False.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the wavelength bins in nanometers (must be <cite>1</cite> or <cite>5</cite>). The
default is <cite>1</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cmf</strong> – The CIE 1931 XYZ 2-deg CMFs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray or pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pyplr.utils"></span><div class="section" id="pyplr-utils">
<h2>pyplr.utils<a class="headerlink" href="#pyplr-utils" title="Permalink to this headline">¶</a></h2>
<p>Scripting tools for working with pupil data.</p>
<p>&#64;author: jtm</p>
<dl class="py function">
<dt id="pyplr.utils.extract">
<code class="sig-prename descclassname">pyplr.utils.</code><code class="sig-name descname">extract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">events</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">duration</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">borrow_attributes</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.utils.extract" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts ranges from samples based on event timing and sample count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – The samples from which to extract events. Index must be timestamp.</p></li>
<li><p><strong>events</strong> (<em>pandas.DataFrame</em>) – The events to extract. Index must be timestamp.</p></li>
<li><p><strong>offset</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to offset from baseline. The default is 0.</p></li>
<li><p><strong>duration</strong> (<em>int</em><em>, </em><em>optional</em>) – Duration of all events in terms of the number of samples. Currently
this has to be the same for all events, but could use a ‘duration’
column in events DataFrame if needs be. The default is 0.</p></li>
<li><p><strong>borrow_attributes</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of column names in the events DataFrame whose values should be
copied to the respective ranges. For each item in the list, a
column will be created in the ranges dataframe - if the column does
not exist in the events dataframe, the values in the each
corresponding range will be set to float(‘nan’). This is uesful for
marking conditions, grouping variables, etc. The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>df</strong> – Extracted events complete with hierarchical multi-index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.utils.load_annotations">
<code class="sig-prename descclassname">pyplr.utils.</code><code class="sig-name descname">load_annotations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.utils.load_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads ‘annotations’ exported from Pupil Player.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_dir</strong> (<em>str</em>) – Directory where the Pupil Labs ‘annotations’ data exists.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>events</strong> – Pandas DataFrame containing annotations / events.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.utils.load_blinks">
<code class="sig-prename descclassname">pyplr.utils.</code><code class="sig-name descname">load_blinks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.utils.load_blinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads ‘blinks’ data exported from Pupil Player.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_dir</strong> (<em>str</em>) – Directory where the Pupil Labs ‘blinks’ data exists.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>blinks</strong> – Pandas DataFrame containing blink events.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.utils.load_pupil">
<code class="sig-prename descclassname">pyplr.utils.</code><code class="sig-name descname">load_pupil</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_dir</span></em>, <em class="sig-param"><span class="n">eye_id</span><span class="o">=</span><span class="default_value">'best'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'3d c++'</span></em>, <em class="sig-param"><span class="n">cols</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.utils.load_pupil" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads ‘pupil_positions.csv’ data exported from Pupil Player.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<em>str</em>) – Directory where the Pupil Labs ‘pupil_positions.csv’ data exists.</p></li>
<li><p><strong>eye</strong> (<em>str</em>) – Eye to load. Must be ‘left’ (1), ‘right’ (0), or ‘best’. If ‘best’,
the eye with the highest average confidence will be loaded. The
default is None.</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>optional</em>) – Whether to load pupil data generated by the 2d or 3d fitting method.
The default is ‘3d c++’.</p></li>
<li><p><strong>cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns to load from the file (check file for options). Must include
[‘pupil_timestap’, ‘method’, ‘confidence’] and The default is None
(loads all columns).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – Pandas DataFrame containing requested samples.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.utils.new_subject">
<code class="sig-prename descclassname">pyplr.utils.</code><code class="sig-name descname">new_subject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rec_dir</span></em>, <em class="sig-param"><span class="n">export</span><span class="o">=</span><span class="default_value">'000'</span></em>, <em class="sig-param"><span class="n">out_dir_nm</span><span class="o">=</span><span class="default_value">'pyplr_analysis'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.utils.new_subject" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a handle on a new subject for data analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rec_dir</strong> (<em>str</em>) – Full path to a Pupil Labs recording directory for a given subject.</p></li>
<li><p><strong>export</strong> (<em>str</em>) – The export folder in which to look for files (in case of multiple
exports). The default is ‘000’.</p></li>
<li><p><strong>out_dir_nm</strong> (<em>str</em><em>, </em><em>optional</em>) – Name for the folder where output will be saved. The default is
‘pyplr_analysis’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If subjdir does not exist.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>s</strong> – Dictionary of subject information.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.utils.print_file_structure">
<code class="sig-prename descclassname">pyplr.utils.</code><code class="sig-name descname">print_file_structure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rec_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.utils.print_file_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the file structure of a recording directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.utils.reject_bad_trials">
<code class="sig-prename descclassname">pyplr.utils.</code><code class="sig-name descname">reject_bad_trials</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em>, <em class="sig-param"><span class="n">interp_thresh</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">drop</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.utils.reject_bad_trials" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop or markup trials which exceed a threshold of interpolated data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ranges</strong> (<em>pandas.DataFrame</em>) – Extracted event ranges with hierarchical pd.MultiIndex.</p></li>
<li><p><strong>interp_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Percentage of interpolated data permitted before trials are marked for
rejection / dropped. The default is 20.</p></li>
<li><p><strong>drop</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to drop the trials from the ranges. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ranges</strong> – Same as ranges but with a column identifying trials marked for
rejection (drop = False) or with those trials dropped from the
DataFrame (drop = True).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pyplr.preproc"></span><div class="section" id="pyplr-preproc">
<h2>pyplr.preproc<a class="headerlink" href="#pyplr-preproc" title="Permalink to this headline">¶</a></h2>
<p>Scripting tools for preprocessing pupil data.</p>
<p>&#64;author: jtm</p>
<dl class="py function">
<dt id="pyplr.preproc.butterworth_series">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">butterworth_series</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">fields</span><span class="o">=</span><span class="default_value">['diameter']</span></em>, <em class="sig-param"><span class="n">filt_order</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">cutoff_freq</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.butterworth_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a Butterworth filter to the given fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<cite>pandas.DataFrame</cite>) – DataFrame of samples containing the pupil data.</p></li>
<li><p><strong>fields</strong> (<em>list</em><em>, </em><em>optional</em>) – List of columns to be filtered. The default is [‘diameter’].</p></li>
<li><p><strong>filt_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of the filter. The default is 3.</p></li>
<li><p><strong>cutoff_freq</strong> (<em>float</em>) – Normalised cut-off frequency in hertz. For 4 Hz cut-off, this should
4/(sample_rate/2). The default is .01.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to modify <cite>samples</cite> in place. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The samples.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>samps</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.ev_row_idxs">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">ev_row_idxs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">blinks</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.ev_row_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indices in ‘samples’ contained in events from ‘events’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – The samples from which to pull indices.</p></li>
<li><p><strong>events</strong> (<em>pandas.DataFrame</em>) – The events whose indices should be pulled from ‘samples’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – Masked data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.even_samples">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">even_samples</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">sample_rate</span></em>, <em class="sig-param"><span class="n">fields</span><span class="o">=</span><span class="default_value">['diameter']</span></em>, <em class="sig-param"><span class="n">zero_index</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.even_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample  data in <cite>fields</cite> to a new index with evenly spaced timepoints.</p>
<p>Pupil Core data samples are unevenly spaced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – The samples.</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – Sampling rate of the data.</p></li>
<li><p><strong>fields</strong> (<em>list</em><em>, </em><em>optional</em>) – The columns to interpolate to new index. The default is [‘diameter’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – DataFrame with evenly spaced index and interpolated data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.get_mask_idxs">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">get_mask_idxs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">blinks</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.get_mask_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds indices from ‘samples’ within the returned events.</p>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.interpolate_blinks">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">interpolate_blinks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">blinks</span></em>, <em class="sig-param"><span class="n">fields</span><span class="o">=</span><span class="default_value">['diameter']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.interpolate_blinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstructs Pupil Labs eye blinks with linear interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – Must contain at least ‘pupil_timestamp’ and ‘diameter’ columns</p></li>
<li><p><strong>blinks</strong> (<em>pandas.DataFrame</em>) – Must contain ‘start_timestamp’ and ‘end_timestamp’ columns</p></li>
<li><p><strong>interp_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns to interpolate. The default is [‘diameter’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – Blink-interpolated data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.interpolate_pupil">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">interpolate_pupil</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">interp_cols</span><span class="o">=</span><span class="default_value">['diameter']</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'linear'</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.interpolate_pupil" title="Permalink to this definition">¶</a></dt>
<dd><p>Use linear interpolation to reconstruct nan values in interp_cols.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – Samples containing the data to be interpolated.</p></li>
<li><p><strong>interp_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns to interpolate. The default is [‘diameter’].</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Linear or polynomial. If polynomial, requires ‘order’ to be specified.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – Masked data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.interpolate_zeros">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">interpolate_zeros</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">fields</span><span class="o">=</span><span class="default_value">['diameter']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.interpolate_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace 0s in “samples” with linearly interpolated data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – The samples in which you’d like to replace 0s</p></li>
<li><p><strong>interp_cols</strong> (<em>list</em>) – The column names from samples in which you’d like to replace 0s.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.mask_blinks">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">mask_blinks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">blinks</span></em>, <em class="sig-param"><span class="n">mask_cols</span><span class="o">=</span><span class="default_value">['diameter']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.mask_blinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets untrustworthy pupil data to NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – Must contain at least ‘pupil_timestamp’ and ‘diameter’ columns</p></li>
<li><p><strong>blinks</strong> (<em>pandas.DataFrame</em>) – Must contain ‘start_timestamp’ and ‘end_timestamp’ columns</p></li>
<li><p><strong>mask_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns to mask. The default is [‘diameter’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – Masked data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.mask_pupil_confidence">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">mask_pupil_confidence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">mask_cols</span><span class="o">=</span><span class="default_value">['diameter']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.mask_pupil_confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets data in mask_cols to NaN where the corresponding confidence metric is
below threshold. Pupil Labs reccommend a threshold of 0.8. Helpful for
dealing with blinks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – Samples containing the data to be masked.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Confidence threshold for masking. The default is 0.8.</p></li>
<li><p><strong>mask_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns to mask. The default is [‘diameter’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – masked data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.mask_pupil_first_derivative">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">mask_pupil_first_derivative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">mask_cols</span><span class="o">=</span><span class="default_value">['diameter']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.mask_pupil_first_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a masking threshold on the first derivative of pupil data.</p>
<p>Use a statistical criterion on the first derivative of pupil data to mask
poor quality data. Helpful for dealing with blinks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – Samples containing the data to be masked.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of standard deviations from the mean of the first derivative
to use as the threshold for masking. The default is 3.0.</p></li>
<li><p><strong>mask_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns to mask. The default is <code class="docutils literal notranslate"><span class="pre">['diameter']</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – masked data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.mask_zeros">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">mask_zeros</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">mask_cols</span><span class="o">=</span><span class="default_value">['diameter']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.mask_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets any 0 values in columns in mask_cols to NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – The samples to search for 0 values.</p></li>
<li><p><strong>(</strong><strong>list of strings</strong><strong>)</strong> (<em>mask_fields</em>) – The columns to search for 0 values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.percent_signal_change">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">percent_signal_change</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em>, <em class="sig-param"><span class="n">baselines</span></em>, <em class="sig-param"><span class="n">pupil_cols</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.percent_signal_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new columns expressing pupil_cols as percent change from baseline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ranges</strong> (<em>pandas.DataFrame</em>) – DataFrame with MultiIndex. Usually the output from <code class="docutils literal notranslate"><span class="pre">utils.extract(...)</span></code></p></li>
<li><p><strong>baselines</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>pupil_cols</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ranges</strong> – Original DataFrame with new columns for percent-signal change.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.pupil_confidence_filter">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">pupil_confidence_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">mask_cols</span><span class="o">=</span><span class="default_value">['diameter']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.pupil_confidence_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets data in mask_cols to NaN where the corresponding confidence metric is
below threshold. Pupil Labs reccommend a threshold of .8. An alterntive
to interpolating blinks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) – The samples from which to pull indices.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold to use for filtering by confidence. The default is .8.</p></li>
<li><p><strong>mask_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns to mask. The default is [‘diameter’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samps</strong> – Masked data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyplr.preproc.savgol_series">
<code class="sig-prename descclassname">pyplr.preproc.</code><code class="sig-name descname">savgol_series</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">fields</span><span class="o">=</span><span class="default_value">['diameter']</span></em>, <em class="sig-param"><span class="n">window_length</span><span class="o">=</span><span class="default_value">51</span></em>, <em class="sig-param"><span class="n">filt_order</span><span class="o">=</span><span class="default_value">7</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.preproc.savgol_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a savitsky-golay filter to the given fields
See documentation on scipys savgol_filter method FMI.</p>
</dd></dl>

</div>
<span class="target" id="module-pyplr.plr"></span><div class="section" id="pyplr-plr">
<h2>pyplr.plr<a class="headerlink" href="#pyplr-plr" title="Permalink to this headline">¶</a></h2>
<p>A module to assist with parametrising and plotting pupillary light responses.</p>
<p>&#64;author: jtm</p>
<dl class="py class">
<dt id="pyplr.plr.PLR">
<em class="property">class </em><code class="sig-prename descclassname">pyplr.plr.</code><code class="sig-name descname">PLR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plr</span></em>, <em class="sig-param"><span class="n">sample_rate</span></em>, <em class="sig-param"><span class="n">onset_idx</span></em>, <em class="sig-param"><span class="n">stim_duration</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to handle data representing a pupil response to a flash of light.</p>
<dl class="py method">
<dt id="pyplr.plr.PLR.acceleration_profile">
<code class="sig-name descname">acceleration_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.acceleration_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the acceleration profile of a PLR. Assumes the samples are
evenly spaced, which is not the case with Pupil Labs data. Smoothing
and averaging across multiple PLRs should remove cause for concern.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.average_constriction_velocity">
<code class="sig-name descname">average_constriction_velocity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.average_constriction_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the average constriction velocity.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.baseline">
<code class="sig-name descname">baseline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the average pupil size between the start of s and onset_idx.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.constriction_amplitude">
<code class="sig-name descname">constriction_amplitude</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.constriction_amplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the constriction amplitude (i.e. the absolute difference
between baseline and peak constriction).</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.constriction_time">
<code class="sig-name descname">constriction_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.constriction_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time difference between constriction latency and peak
constriction.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.latency_idx_a">
<code class="sig-name descname">latency_idx_a</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.latency_idx_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index where pupil size passes 1% change from size at
light  onset.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.latency_idx_b">
<code class="sig-name descname">latency_idx_b</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.latency_idx_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of peak negative acceleration in the second after
light onset.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.latency_to_constriction_a">
<code class="sig-name descname">latency_to_constriction_a</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.latency_to_constriction_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time in miliseconds between stimulus onset and the first
sample where constriction exceeds a percentage of the baseline, using
the percent change threshold.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.latency_to_constriction_b">
<code class="sig-name descname">latency_to_constriction_b</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.latency_to_constriction_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time in miliseconds between stimulus onset and the time
at which the pupil reaches maximal negative acceleration within a
1-s window. See Bergamin &amp; Kardon (2003) for justification. Requires
well-smoothed pupil data.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.max_constriction_acceleration">
<code class="sig-name descname">max_constriction_acceleration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.max_constriction_acceleration" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum constriction acceleration.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.max_constriction_velocity">
<code class="sig-name descname">max_constriction_velocity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.max_constriction_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum constriction velocity.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.max_redilation_acceleration">
<code class="sig-name descname">max_redilation_acceleration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.max_redilation_acceleration" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum redilation acceleration.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.max_redilation_velocity">
<code class="sig-name descname">max_redilation_velocity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.max_redilation_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum redilation velocity.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.parameters">
<code class="sig-name descname">parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Collapse a PLR into descriptive parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plr</strong> (<em>array-like</em>) – Data representing a pupil’s response to light in mm units.</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – sampling rate of the measurement system.</p></li>
<li><p><strong>onset_idx</strong> (<em>int</em>) – index of the onset of the light stimulus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>params</strong> – DataFrame containins the params.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.peak_constriction">
<code class="sig-name descname">peak_constriction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.peak_constriction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the peak constriction value (i.e., the smallest pupil size).</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.peak_constriction_idx">
<code class="sig-name descname">peak_constriction_idx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.peak_constriction_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the sample with peak constriction.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vel</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">acc</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">print_params</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a PLR with option to add descriptive parameters and velocity /
acceleration profiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vel_acc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to also plot the velocity and acceleration profiles.
The default is False.</p></li>
<li><p><strong>print_params</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to annotate the axis with the results of a call to
<code class="docutils literal notranslate"><span class="pre">.parameters(...)</span></code>. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fig</strong> – The plot.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.pupil_size_at_onset">
<code class="sig-name descname">pupil_size_at_onset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.pupil_size_at_onset" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pupil size at stimulus onset.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.time_to_75pc_recovery">
<code class="sig-name descname">time_to_75pc_recovery</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.time_to_75pc_recovery" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time in ms until 75% recovery from baseline.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.time_to_max_constriction">
<code class="sig-name descname">time_to_max_constriction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.time_to_max_constriction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time in miliseconds between stimulus onset and the peak
of pupil constriction.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.time_to_max_velocity">
<code class="sig-name descname">time_to_max_velocity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.time_to_max_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time between stimulus onset and when pupil constriction
reaches maximum velocity.</p>
</dd></dl>

<dl class="py method">
<dt id="pyplr.plr.PLR.velocity_profile">
<code class="sig-name descname">velocity_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyplr.plr.PLR.velocity_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the velocity profile of the PLR. Assumes the samples are
evenly spaced, which is not the case with Pupil Labs data. Smoothing
and averaging across multiple PLRs should remove cause for concern.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-pyplr.graphing"></span><p>Created on Wed Dec 16 14:12:12 2020</p>
<p>&#64;author: jtm</p>
<p class="rubric">Tables and indices</p>
<hr class="docutils" />
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/orange_eye.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">PyPlr</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="02_purpose.html">Purpose</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_example_protocols.html">Example protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_example_analyses.html">Example analyses</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-pupil">pyplr.pupil</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-stlab">pyplr.stlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-oceanops">pyplr.oceanops</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-calibrate">pyplr.calibrate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-cie">pyplr.CIE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-utils">pyplr.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-preproc">pyplr.preproc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyplr-plr">pyplr.plr</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="08_developers.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_funding.html">Funding</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="pupil_core_timing_analysis.html" title="previous chapter">Pupil Core device timing</a></li>
      <li>Next: <a href="08_developers.html" title="next chapter">Developers</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Joel T. Martin and Manuel Spitschan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/07_api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>